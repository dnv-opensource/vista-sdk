<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFrameworks>net7.0;net6.0;netstandard2.0</TargetFrameworks>
    <IsPackable>true</IsPackable>
    <PackageId>DNV.Vista.SDK.System.Text.Json</PackageId>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="System.Text.Json" Version="$(DotNetVersion)" />
    <PackageReference Include="NSwag.MSBuild" Version="13.15.10">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
    </PackageReference>
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\Vista.SDK\Vista.SDK.csproj" />
  </ItemGroup>

  <Target Name="DataChannelListGeneration" AfterTargets="BeforeBuild" Condition="'$(CI_BUILD)' != 'True'">
    <Exec Command="$(NSwagExe_Net60) jsonschema2csclient ^&#xD;&#xA;          /input:../../../schemas/json/DataChannelList.schema.json ^&#xD;&#xA;          /output:DataChannelList/DataChannelList.cs ^&#xD;&#xA;          /Name:DataChannelListPackage ^&#xD;&#xA;          /Namespace:Vista.SDK.Transport.Json.DataChannel ^&#xD;&#xA;          /GenerateDataAnnotations:false ^&#xD;&#xA;          /ArrayType:System.Collections.Generic.IReadOnlyList ^&#xD;&#xA;          /ArrayInstanceType:System.Collections.Generic.List ^&#xD;&#xA;          /DictionaryType:System.Collections.Generic.IReadOnlyDictionary ^&#xD;&#xA;          /DictionaryInstanceType:System.Collections.Generic.Dictionary ^&#xD;&#xA;          /ArrayBaseType:System.Collections.Generic.IReadOnlyList ^&#xD;&#xA;          /DictionaryBaseType:System.Collections.Generic.IReadOnlyDictionary ^&#xD;&#xA;          /GenerateImmutableArrayProperties:true ^&#xD;&#xA;          /GenerateImmutableDictionaryProperties:true ^&#xD;&#xA;          /GenerateNullableReferenceTypes:true ^&#xD;&#xA;          /GenerateOptionalPropertiesAsNullable:true ^&#xD;&#xA;          /ClassStyle:Record ^&#xD;&#xA;          /JsonLibrary:SystemTextJson" />
  </Target>

  <Target Name="TimeSeriesDAtaGeneration" AfterTargets="BeforeBuild" Condition="'$(CI_BUILD)' != 'True'">
    <Exec Command="$(NSwagExe_Net60) jsonschema2csclient ^&#xD;&#xA;          /input:../../../schemas/json/TimeSeriesData.schema.json ^&#xD;&#xA;          /output:TimeSeriesData/TimeSeriesData.cs ^&#xD;&#xA;          /Name:TimeSeriesDataPackage ^&#xD;&#xA;          /Namespace:Vista.SDK.Transport.Json.TimeSeriesData ^&#xD;&#xA;          /GenerateDataAnnotations:false ^&#xD;&#xA;          /ArrayType:System.Collections.Generic.IReadOnlyList ^&#xD;&#xA;          /ArrayInstanceType:System.Collections.Generic.List ^&#xD;&#xA;          /DictionaryType:System.Collections.Generic.IReadOnlyDictionary ^&#xD;&#xA;          /DictionaryInstanceType:System.Collections.Generic.Dictionary ^&#xD;&#xA;          /ArrayBaseType:System.Collections.Generic.IReadOnlyList ^&#xD;&#xA;          /DictionaryBaseType:System.Collections.Generic.IReadOnlyDictionary ^&#xD;&#xA;          /GenerateImmutableArrayProperties:true ^&#xD;&#xA;          /GenerateImmutableDictionaryProperties:true ^&#xD;&#xA;          /GenerateNullableReferenceTypes:true ^&#xD;&#xA;          /GenerateOptionalPropertiesAsNullable:true ^&#xD;&#xA;          /ClassStyle:Record ^&#xD;&#xA;          /JsonLibrary:SystemTextJson" />
  </Target>

</Project>
